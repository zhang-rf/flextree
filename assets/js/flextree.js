!function($){"use strict";var cssFlextree="js-flextree",selFlextree="."+cssFlextree,dataCollapsible="flextree-collapsible",dataExclusiveNode="flextree-exclusive",dataFixDblClickBug="flextree-dblbug",dataExpanded="flextree-expanded",eventActivate="activate.flextree",ulPadding="1em",ulTemplate='<ul class="'+cssFlextree+'" style="margin: 0;padding: 0;list-style-type: none;"/>';$.flextree={eventActivate:eventActivate,tree:function(e,t,l,r){if(e=e.concat(),t&&"string"!=typeof t&&(r=l,l=t,t=void 0),l&&"object"!=typeof l&&(r=l,l=void 0),r&&"function"!=typeof r&&(l=void 0),t=t||$.flextree.global.template,l=l||$.flextree.global.args||{},l.id||(l.id="id"),l.parentId||(l.parentId="parent_id",e.length>0&&("parentId"in e[0]?l.parentId="parentId":"parentid"in e[0]&&(l.parentId="parentid"))),l.correctParent){var n=[];e.forEach(function(e){n.push(e[l.id])}),e.forEach(function(e){var t=e[l.parentId];t&&-1==n.indexOf(t)&&(e[l.parentId]=null)})}var i=$(ulTemplate),a={"":i};do{var s=!1;e.forEach(function(n,d){var o=n[l.parentId]||"";if(o in a){var u=n[l.id],c=a[o];if(!c.is("ul")){var f=$("<li/>").addClass(cssFlextree);l.collapsible&&f.css("display","none"),c=$(ulTemplate).css("padding-left",$.flextree.global.padding||ulPadding),f.append(c),a[o].after(f),a[o]=c}var p=t;for(var x in n)n.hasOwnProperty(x)&&(p=p.replace(new RegExp("{"+x+"}","g"),n[x]||""));var v=$(p);if(v.is("li")||(v=$("<li/>").append(v)),i.data(dataCollapsible,l.collapsible||!1),i.data(dataExclusiveNode,l.exclusiveNode!==!1),i.data(dataFixDblClickBug,l.fixDblClickBug||!1),l.collapsible){var h=l.exclusiveNode;if(v.on(eventActivate,function(){$(this).data(dataExpanded)?$(this).removeData(dataExpanded):$(this).data(dataExpanded,!0),$(this).next().filter(selFlextree).slideToggle("fast"),h!==!1&&$(this).siblings().removeData(dataExpanded).filter(selFlextree).not($(this).next()).slideUp("fast")}),null!==l.collapseEvent){var g="click";null!=l.collapseEvent&&(g=l.collapseEvent),v.on(g,function(e){$(e.target).is("input")||$(this).trigger(eventActivate)})}l.fixDblClickBug&&!function(){function e(){e.timer&&(clearTimeout(e.timer),e.timer=null)}v.on("click",function(t){if(!t.isClick){var l=$(t.target);l.is("input")||(e.timer?e():e.timer=setTimeout(function(){e(),l.trigger($.Event("click",{isClick:!0}))},300))}})}()}var F=r||l.onBind;if(F){var m=v.get(0);F.call(m,n,d,m)}c.append(v),a[u]=v,delete e[d],s=!0}})}while(s);return i},getInternal:function(varName){return"string"==typeof varName&&/^\w+$/.test(varName)?eval(varName):void 0}},$.flextree.global={},$.fn.tree=function(){var e=$.flextree.tree.apply(void 0,Array.prototype.slice.call(arguments)),t=$(this),l=t.treeChildren().parent();return 0!=l.length&&(t=l),t.is("ul")?(e.children().appendTo(t),e=t):t.parent().is(selFlextree)?t.after($("<li/>").addClass(cssFlextree).append(e.css("padding-left",$.flextree.global.padding||ulPadding))):t.append(e),e},$.fn.extend(function(){function e(e){var t=$(e);return t.is("li")?t:t.parentsUntil(selFlextree,"li")}return{treeParent:function(){return e(this).parent().parent(selFlextree).prev()},treeParents:function(){return e(this).parents("li"+selFlextree).prev()},treeChildren:function(){return e(this).next().filter(selFlextree).children().children().not(selFlextree)},treeFind:function(){return e(this).next().filter(selFlextree).find("ul"+selFlextree).children().not(selFlextree)},treeSiblings:function(){return e(this).siblings().not(selFlextree)},treeNext:function(){var e=$();return $.each(this,function(){e=e.add($(this).nextAll().not(selFlextree).first())}),e},treeNextAll:function(){return e(this).nextAll().not(selFlextree)},treePrev:function(){var e=$();return $.each(this,function(){e=e.add($(this).prevAll().not(selFlextree).first())}),e},treePrevAll:function(){return e(this).prevAll().not(selFlextree)},treeNode:function(){return e(this)},treeRoot:function(){var e=$(this).parents("ul"+selFlextree);return 0==e.length?$(this).filter("ul"+selFlextree):e.last()},treeAll:function(){return $(this).find("li:not("+selFlextree+")").filter("ul"+selFlextree+" li:not("+selFlextree+")")},treeActivate:function(){return e(this).trigger(eventActivate),this},treeExpanded:function(){return 1==e(this).data(dataExpanded)}}}()),"undefined"!=typeof module&&module.exports&&(module.exports=$.flextree)}("undefined"!=typeof module&&module.exports?require("jquery"):jQuery);